<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>s-cadnano</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="images/favicon.ico">

    <script src="external-libs/svg-pan-zoom.min.js"></script>
    <script src="external-libs/hammer.min.js"></script>

    <!--    the documentation doesn't say it, but we need to include this reference to split.min.js -->
    <script src="packages/split/split.min.js"></script>

    <link href="packages/codemirror/codemirror.css" rel="stylesheet">
    <link href="packages/codemirror/addon/hint/show-hint.css" rel="stylesheet">
    <script src="packages/codemirror/codemirror.js"></script>
    <script src="packages/codemirror/mode/python/python.js"></script>
</head>

<body>


<div class="top-container">

    <!--    <div class="split" id="noneditor-pane">-->

    <div id="menu"></div>

    <div class="menu-separator" id="menu-separator"></div>

    <div class="panes-container">

        <div class="split" id="side-pane">
            <svg id="side-view-svg" width="100%" height="100%" style="touch-action: none;">
                <g id="side-view-svg-viewport">
                    <circle id="dummy-elt-side-view" r="100" cx="100" cy="50" fill="white">
                        dummy elt for svg-pan-zoom not to have a divide-by-0 error due to 0 width/height
                    </circle>
                </g>
            </svg>
        </div>

        <div class="split" id="main-pane">
            <svg id="main-view-svg" width="100%" height="100%" style="touch-action: none;">
                <g id="main-view-svg-viewport">
                    <circle id="dummy-elt-main-view" r="200" cx="100" cy="100" fill="white">
                        dummy elt for svg-pan-zoom not to have a divide-by-0 error due to 0 width/height
                    </circle>
                </g>
            </svg>
        </div>

        <!--    </div>-->

        <div class="split" id="editor-pane">
            <div id="controls">
                <label for="theme">Theme:</label>
                <select id="theme"></select>
            </div>
            <div id="editor"></div>
            <p id="footer"></p>
        </div>

    </div>

</div>

<script defer src="main.dart.js"></script>

<script>
    window.onload = function () {





        var eventsHandler;

        eventsHandler = {
            haltEventListeners: ['touchstart', 'touchend', 'touchmove', 'touchleave', 'touchcancel']
            , init: function(options) {
                var instance = options.instance
                    , initialScale = 1
                    , pannedX = 0
                    , pannedY = 0

                // Init Hammer
                // Listen only for pointer and touch events
                this.hammer = Hammer(options.svgElement, {
                    inputClass: Hammer.SUPPORT_POINTER_EVENTS ? Hammer.PointerEventInput : Hammer.TouchInput
                })

                // Enable pinch
                this.hammer.get('pinch').set({enable: true})

                // Handle double tap
                this.hammer.on('doubletap', function(ev){
                    instance.zoomIn()
                })

                // Handle pan
                this.hammer.on('panstart panmove', function(ev){
                    // On pan start reset panned variables
                    if (ev.type === 'panstart') {
                        pannedX = 0
                        pannedY = 0
                    }

                    // Pan only the difference
                    instance.panBy({x: ev.deltaX - pannedX, y: ev.deltaY - pannedY})
                    pannedX = ev.deltaX
                    pannedY = ev.deltaY
                })

                // Handle pinch
                this.hammer.on('pinchstart pinchmove', function(ev){
                    // On pinch start remember initial zoom
                    if (ev.type === 'pinchstart') {
                        initialScale = instance.getZoom()
                        instance.zoomAtPoint(initialScale * ev.scale, {x: ev.center.x, y: ev.center.y})
                    }

                    instance.zoomAtPoint(initialScale * ev.scale, {x: ev.center.x, y: ev.center.y})
                })

                // Prevent moving the page on some devices when panning over SVG
                options.svgElement.addEventListener('touchmove', function(e){ e.preventDefault(); });
            }

            , destroy: function(){
                this.hammer.destroy()
            }
        }










        svgPanZoom('#side-view-svg', {
            viewportSelector: "#side-view-svg-viewport",
            zoomScaleSensitivity: 0.3,
            minZoom: 0.05,
            maxZoom: 20,
            customEventsHandler: eventsHandler,
        });
        svgPanZoom('#main-view-svg', {
            viewportSelector: "#main-view-svg-viewport",
            zoomScaleSensitivity: 0.3,
            minZoom: 0.05,
            maxZoom: 20,
            customEventsHandler: eventsHandler,
        });
        // attempting to remove the dummy node here causes a race condition with the Dart code that clears out
        // DOM children before rendering, so we just leave it in.
        // removeDummy("dummy-elt-side-view");
        // removeDummy("dummy-elt-main-view");
    }
</script>


<!--Useful for temporarily rendering nodes to query info; e.g., width of an element-->
<div id="temp-div"></div>

</body>

</html>
